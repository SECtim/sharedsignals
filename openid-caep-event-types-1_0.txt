



Shared Signals and Events                                    T. Cappalli
Internet-Draft                                                 Microsoft
Intended status: Standards Track                        A. Tulshibagwale
Expires: September 18, 2021                                       Google
                                                          March 17, 2021


                      OpenID CAEP Event Types 1.0
                      openid-caep-event-types-1_0

Abstract

   This document defines the Continuous Access Evaluation Protocol
   (CAEP) Event Types for the Shared Signals and Events Profile of IETF
   Security Events 1.0 [SSE-PROFILE].

   Event Types are introduced and defined in Security Event Token (SET)
   [RFC8417].

Status of This Memo

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 18, 2021.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.







Cappalli & TulshibagwalExpires September 18, 2021               [Page 1]

Internet-Draft              CAEP-Event-Types                  March 2021


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Notational Considerations . . . . . . . . . . . . . . . .   2
   2.  Required Event Claims . . . . . . . . . . . . . . . . . . . .   2
   3.  Optional Event Claims . . . . . . . . . . . . . . . . . . . .   3
   4.  Event Types . . . . . . . . . . . . . . . . . . . . . . . . .   3
     4.1.  Session Revoked . . . . . . . . . . . . . . . . . . . . .   3
       4.1.1.  Event-Specific Claims . . . . . . . . . . . . . . . .   4
       4.1.2.  Examples  . . . . . . . . . . . . . . . . . . . . . .   4
     4.2.  Token Claims Change . . . . . . . . . . . . . . . . . . .   7
       4.2.1.  Event-Specific Claims . . . . . . . . . . . . . . . .   8
       4.2.2.  Examples  . . . . . . . . . . . . . . . . . . . . . .   8
     4.3.  Credential Change . . . . . . . . . . . . . . . . . . . .  10
       4.3.1.  Event-Specific Claims . . . . . . . . . . . . . . . .  11
       4.3.2.  Examples  . . . . . . . . . . . . . . . . . . . . . .  11
     4.4.  Assurance Level Change  . . . . . . . . . . . . . . . . .  12
       4.4.1.  Event-Specific Claims . . . . . . . . . . . . . . . .  13
       4.4.2.  Examples  . . . . . . . . . . . . . . . . . . . . . .  13
     4.5.  Device Compliance Change  . . . . . . . . . . . . . . . .  14
       4.5.1.  Attributes  . . . . . . . . . . . . . . . . . . . . .  14
       4.5.2.  Examples  . . . . . . . . . . . . . . . . . . . . . .  15
   5.  Normative References  . . . . . . . . . . . . . . . . . . . .  16
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  17

1.  Introduction

   This specification is based on the Shared Signals and Events Profile
   of IETF Security Events 1.0 [SSE-PROFILE] and uses the subject
   identifiers defined there.

1.1.  Notational Considerations

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.  Required Event Claims

   The following claims are required in all CAEP events defined in this
   specification.

   event_timestamp  REQUIRED, JSON number: the time at which the session
      revocation occurred.  Its value is a JSON number representing the
      number of milliseconds from 1970-01-01T0:0:0Z as measured in UTC




Cappalli & TulshibagwalExpires September 18, 2021               [Page 2]

Internet-Draft              CAEP-Event-Types                  March 2021


      until the date/time.  The receiver SHOULD reject events if this
      claim's value is in the future.

3.  Optional Event Claims

   The following claims are optional unless otherwise specified in the
   event definition.

   initiating_entity  OPTIONAL, JSON string: describes the entity that
      invoked the event.

      Potential options:

      *  "admin": an administrative action resulted in the event

      *  "user": an end-user action resulted in the event

      *  "policy": a policy evaluation resulted in the event

      *  "system": a system or platform assertion resulted in the event

   reason_admin  OPTIONAL, JSON string: an administrative message for
      logging and auditing

   reason_user  OPTIONAL, JSON string: a user-friendly message for
      display to an end-user

4.  Event Types

   The base URI for CAEP event types is:

   "https://schemas.openid.net/secevent/caep/event-type/"

4.1.  Session Revoked

   Event Type URI:

   "https://schemas.openid.net/secevent/caep/event-type/session-revoked"

   Session Revoked signals that the session identified by the subject
   has been revoked.  The explicit session identifier may be directly
   referenced in the subject or other properties of the session may be
   included to allow the receiver to identify applicable sessions.

   When a Complex Claim is used as the subject, the revocation event
   applies to any session derived from matching those combined claims.





Cappalli & TulshibagwalExpires September 18, 2021               [Page 3]

Internet-Draft              CAEP-Event-Types                  March 2021


   The actual reason why the session was revoked might be specified with
   the nested "reason_admin" and/or "reason_user" claims described in
   Section 3.

4.1.1.  Event-Specific Claims

   There are no event-specific claims for this event type.

4.1.2.  Examples

   NOTE: The event type URI is wrapped, the backslash is the
   continuation character.

   {
       "iss": "https://idp.example.com/123456789/",
       "jti": "24c63fb56e5a2d77a6b512616ca9fa24",
       "iat": 1615305159,
       "aud": "https://sp.example.com/caep",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           session-revoked": {
               "subject": {
                   "format": "opaque",
                   "sub": "dMTlD|1600802906337.16|16008.16"
               },
               "event_timestamp": 1615304991643
           }
       }
   }

   Figure 1: Example: Session Revoked - Required claims + Simple Subject




















Cappalli & TulshibagwalExpires September 18, 2021               [Page 4]

Internet-Draft              CAEP-Event-Types                  March 2021


   {
       "iss": "https://idp.example.com/123456789/",
       "jti": "24c63fb56e5a2d77a6b512616ca9fa24",
       "iat": 1615305159,
       "aud": "https://sp.example.com/caep",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           session-revoked": {
               "subject": {
                   "session": {
                     "format": "opaque",
                     "sub": "dMTlD|1600802906337.16|16008.16"
                   },
                   "user": {
                     "format": "iss_sub",
                     "iss": "https://idp.example.com/123456789/",
                     "sub": "dMTlD|1600802906337.16|16008.16"
                   },
                   "tenant": {
                     "format": "opaque",
                     "id": "123456789"
                   }
               },
               "initiating_entity": "policy",
               "reason_admin": "Landspeed Policy Violation: C076E82F",
               "reason_user": "Access attempt from multiple regions.",
               "event_timestamp": 1615304991643
           }
       }
   }

   Figure 2: Example: Session Revoked - Complex Subject describing user
             + session ID + device (includes optional claims)


















Cappalli & TulshibagwalExpires September 18, 2021               [Page 5]

Internet-Draft              CAEP-Event-Types                  March 2021


   {
       "iss": "https://idp.example.com/123456789/",
       "jti": "24c63fb56e5a2d77a6b512616ca9fa24",
       "iat": 1615305159,
       "aud": "https://sp.example.com/caep",
       "sub": "jane.smith@example.com",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           session-revoked": {
               "initiating_entity": "policy",
               "reason_admin": "Landspeed Policy Violation: C076E82F",
               "reason_user": "Access attempt from multiple regions.",
               "event_timestamp": 1615304991643
           }
       }
   }

   Figure 3: Example: Session Revoked - subject as `sub` claim (includes
                             optional claims)
































Cappalli & TulshibagwalExpires September 18, 2021               [Page 6]

Internet-Draft              CAEP-Event-Types                  March 2021


   {
       "iss": "https://idp.example.com/123456789/",
       "jti": "24c63fb56e5a2d77a6b512616ca9fa24",
       "iat": 1615305159,
       "aud": "https://sp.example.com/caep",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           session-revoked": {
               "subject": {
                   "user": {
                       "format": "iss_sub",
                       "iss": "https://idp.example.com/123456789/",
                       "sub": "jane.smith@example.com"
                   },
                   "device": {
                       "format": "iss_sub",
                       "iss": "https://idp.example.com/123456789/",
                       "sub": "e9297990-14d2-42ec-a4a9-4036db86509a"
                   },
                   "tenant": {
                     "format": "opaque",
                     "id": "123456789"
                   }
               },
               "initiating_entity": "policy",
               "reason_admin": "Policy Violation: C076E82F",
               "reason_user": "This device is no longer compliant.",
               "event_timestamp": 1615304991643
           }
       }
   }

   Figure 4: Example: Session Revoked - Complex Subject describing user
               + device + tenant (includes optional claims)

4.2.  Token Claims Change

   Event Type URI:

   "https://schemas.openid.net/secevent/caep/event-type/token-claims-
   change"

   Token Claims Change signals that a claim in a token, identified by
   the subject claim, has changed.

   The actual reason why the claims change occurred might be specified
   with the nested "reason_admin" and/or "reason_user" claims made in
   Section 3.



Cappalli & TulshibagwalExpires September 18, 2021               [Page 7]

Internet-Draft              CAEP-Event-Types                  March 2021


4.2.1.  Event-Specific Claims

   claims  REQUIRED, JSON object: one or more claims with their new
      value(s)

4.2.2.  Examples

   NOTE: The event type URI is wrapped, the backslash is the
   continuation character.

   {
       "iss": "https://idp.example.com/987654321/",
       "jti": "9afce1e4e642b165fcaacdd0e7aa4903",
       "iat": 1615305159,
       "aud": "https://sp.example2.net/caep",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           token-claims-change": {
               "subject": {
                   "format": "jwt_id",
                   "iss": "https://idp.example.com/987654321/",
                   "jti": "f61t6e20zdo3px56gepu8rzlsp4c1dpc0fx7"
               },
               "event_timestamp": 1615304991643,
               "claims": {
                   "role": "ro-admin"
               }
           }
       }
   }

   Figure 5: Example: OIDC ID Token Claims Change - Required claims only



















Cappalli & TulshibagwalExpires September 18, 2021               [Page 8]

Internet-Draft              CAEP-Event-Types                  March 2021


{
    "iss": "https://idp.example.com/987654321/",
    "jti": "9afce1e4e642b165fcaacdd0e7aa4903",
    "iat": 1615305159,
    "aud": "https://sp.example2.net/caep",
    "events": {
        "https://schemas.openid.net/secevent/caep/event-type/\
        token-claims-change": {
            "subject": {
                "format": "jwt_id",
                "iss": "https://idp.example.com/987654321/",
                "jti": "f61t6e20zdo3px56gepu8rzlsp4c1dpc0fx7"
            },
            "event_timestamp": 1615304991643,
            "initiating_entity": "policy",
            "reason_admin": "User left trusted network: CorpNet3",
            "reason_user": "You're no longer connected to a trusted network.",
            "claims": {
                "trusted_network": "false"
            }
        }
    }
}

     Figure 6: Example: OIDC ID Token Claims Change - Optional claims


























Cappalli & TulshibagwalExpires September 18, 2021               [Page 9]

Internet-Draft              CAEP-Event-Types                  March 2021


   {
       "iss": "https://idp.example.com/987654321/",
       "jti": "dae94fed5f459881efa38b65c6772ddc",
       "iat": 1615305159,
       "aud": "https://sp.example2.net/caep",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           token-claims-change": {
               "subject": {
                   "format": "saml_assertion_id",
                   "issuer": "https://idp.example.com/987654321/",
                   "assertion_id": "_a75adf55-01d7-dbd8372ebdfc"
               },
               "event_timestamp": 1615304991643,
               "claims": {
                   "http://schemas.xmlsoap.org/ws/2005/05/identity/\
                   claims/role": "ro-admin"
               }
           }
       }
   }

     Figure 7: Example: SAML Assertion Claims Change - Required claims
                                   only

4.3.  Credential Change

   Event Type URI:

   "https://schemas.openid.net/secevent/caep/event-type/credential-
   change"

   The Credential Change event signals that a credential was created,
   changed, revoked or deleted.  Credential Change scenarios include:

   o  password/PIN change/reset

   o  certificate enrollment, renewal, revocation and deletion

   o  second factor / passwordless credential enrollment or deletion
      (U2F, FIDO2, OTP, app-based)

   The actual reason why the credential change occurred might be
   specified with the nested "reason_admin" and/or "reason_user" claims
   made in Section 3.






Cappalli & TulshibagwalExpires September 18, 2021              [Page 10]

Internet-Draft              CAEP-Event-Types                  March 2021


4.3.1.  Event-Specific Claims

   credential_type  REQUIRED, JSON string: potential options: -
      "password" - "pin" - "x509" - "fido2-platform" - "fido2-roaming" -
      "fido-u2f" - "verifiable-credential" - "phone-voice" - "phone-sms"
      - "app" - other mutually supported credential type

   change_type  REQUIRED, JSON string: potential options: - "create" -
      "revoke" - "update" - "delete"

   friendly_name  OPTIONAL, JSON string: credential friendly name

   x509_issuer  OPTIONAL, JSON string: issuer of the X.509 certificate
      as defined in [RFC5280]

   x509_serial  OPTIONAL, JSON string: serial number of the X.509
      certificate as defined in [RFC5280]

   fido2_aaguid  OPTIONAL, JSON string: FIDO2 Authenticator Attestation
      GUID as defined in [WebAuthn]

4.3.2.  Examples

   NOTE: The event type URI is wrapped, the backslash is the
   continuation character.


























Cappalli & TulshibagwalExpires September 18, 2021              [Page 11]

Internet-Draft              CAEP-Event-Types                  March 2021


   {
       "iss": "https://idp.example.com/3456789/",
       "jti": "07efd930f0977e4fcc1149a733ce7f78",
       "iat": 1615305159,
       "aud": "https://sp.example2.net/caep",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           credential-change": {
               "subject": {
                   "format": "iss_sub",
                   "iss": "https://idp.example.com/3456789/",
                   "sub": "jane.smith@example.com"
               },
               "credential_type": "fido2-roaming",
               "change_type": "create",
               "fido2_aaguid": "accced6a-63f5-490a-9eea-e59bc1896cfc",
               "friendly_name": "Jane's USB authenticator",
               "initiating_entity": "user",
               "reason_admin": "User self-enrollment",
               "event_timestamp": 1615304991643
           }
       }
   }

    Figure 8: Example: Provisioning a new FIDO2 authenticator - Simple
                         Subject + optional claims

4.4.  Assurance Level Change

   Event Type URI:

   "https://schemas.openid.net/secevent/caep/event-type/assurance-level-
   change"

   The Assurance Level Change event signals that there has been a change
   in authentication method since the initial user login.  This change
   can be from a weak authentication method to a strong authentication
   method, or vice versa.

   In the first scenario, Assurance Level Change will an increase, while
   in the second scenario it will be a decrease.  For example, a user
   can start a session with Service Provider A using single factor
   authentication (such as a password).  The user can then open another
   session with Service Provider B using two-factor authentication (such
   as OTP).  In this scenario an increase Assurance Level Change event
   will signal to Service Provider A that user has authenticated with a
   stronger authentication method.




Cappalli & TulshibagwalExpires September 18, 2021              [Page 12]

Internet-Draft              CAEP-Event-Types                  March 2021


   The actual reason why the assurance level changed might be specified
   with the nested "reason_admin" and/or "reason_user" claims made in
   Section 3.

4.4.1.  Event-Specific Claims

   current_level  REQUIRED, JSON string: the current NIST Authenticator
      Assurance Level (AAL) as defined in [SP800-63R3]

      Potential options:

      *  "nist-aal1"

      *  "nist-aal2"

      *  "nist-aal3"

   previous_level  REQUIRED, JSON string: the previous NIST
      Authenticator Assurance Level (AAL) as defined in [SP800-63R3]

      Potential options:

      *  "nist-aal1"

      *  "nist-aal2"

      *  "nist-aal3"

   change_direction  REQUIRED, JSON string: the Authenticator Assurance
      Level increased or decreased

      Potential options: - "increase" - "decrease"

4.4.2.  Examples

   NOTE: The event type URI is wrapped, the backslash is the
   continuation character.














Cappalli & TulshibagwalExpires September 18, 2021              [Page 13]

Internet-Draft              CAEP-Event-Types                  March 2021


   {
       "iss": "https://idp.example.com/3456789/",
       "jti": "07efd930f0977e4fcc1149a733ce7f78",
       "iat": 1615305159,
       "aud": "https://sp.example2.net/caep",
       "events": {
           "https://schemas.openid.net/secevent/caep/event-type/\
           assurance-level-change": {
               "subject": {
                   "format": "iss_sub",
                   "iss": "https://idp.example.com/3456789/",
                   "sub": "jane.smith@example.com"
               },
               "current_level": "nist-aal2",
               "previous_level": "nist-aal1",
               "change_direction": "increase",
               "initiating_entity": "user",
               "event_timestamp": 1615304991643
           }
       }
   }

      Figure 9: Example: Assurance Level Increase - Simple Subject +
                              optional claims

4.5.  Device Compliance Change

   Event Type URI:

   "https://schemas.openid.net/secevent/caep/event-type/device-
   compliance-change"

   Device Compliance Change signals that a device's compliance status
   has changed.

   The actual reason why the status change occurred might be specified
   with the nested "reason_admin" and/or "reason_user" claims made in
   Section 3.

4.5.1.  Attributes

   previous_status  REQUIRED, JSON string: the compliance status prior
      to the change that triggered the event

      Potential options:

      *  "compliant"




Cappalli & TulshibagwalExpires September 18, 2021              [Page 14]

Internet-Draft              CAEP-Event-Types                  March 2021


      *  "not-compliant"

   current_status  REQUIRED, JSON string: the current status that
      triggered the event

      Potential options:

      *  "compliant"

      *  "not-compliant"

4.5.2.  Examples

   NOTE: The event type URI is wrapped, the backslash is the
   continuation character.

{
    "iss": "https://idp.example.com/123456789/",
    "jti": "24c63fb56e5a2d77a6b512616ca9fa24",
    "iat": 1615305159,
    "aud": "https://sp.example.com/caep",
    "events": {
        "https://schemas.openid.net/secevent/caep/event-type/\
        device-compliance-change": {
            "subject": {
                "device": {
                    "format": "iss_sub",
                    "iss": "https://idp.example.com/123456789/",
                    "sub": "e9297990-14d2-42ec-a4a9-4036db86509a"
                },
                "tenant": {
                    "format": "opaque",
                    "id": "123456789"
                }
            },
            "current_status": "not-compliant",
            "previous_status": "compliant",
            "initiating_entity": "policy",
            "reason_admin": "Location Policy Violation: C076E82F",
            "reason_user": "Device is no longer in a trusted location.",
            "event_timestamp": 1615304991643
        }
    }
}

    Figure 10: Example: Device No Longer Compliant - Complex Subject +
                              optional claims




Cappalli & TulshibagwalExpires September 18, 2021              [Page 15]

Internet-Draft              CAEP-Event-Types                  March 2021


5.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC2616]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", RFC 2616,
              DOI 10.17487/RFC2616, June 1999,
              <https://www.rfc-editor.org/info/rfc2616>.

   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,
              <https://www.rfc-editor.org/info/rfc5280>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8417]  Hunt, P., Ed., Jones, M., Denniss, W., and M. Ansari,
              "Security Event Token (SET)", RFC 8417,
              DOI 10.17487/RFC8417, July 2018,
              <https://www.rfc-editor.org/info/rfc8417>.

   [SP800-63R3]
              Grassi, P., Garcia, M., and J. Fenton, "NIST Special
              Publication 800-63: Digital Identity Guidelines", June
              2017, <https://pages.nist.gov/800-63-3/sp800-63-3.html>.

   [SSE-PROFILE]
              Tulshibagwale, A., Cappalli, T., Scurtescu, M., Backman,
              A., and . John Bradley, "OpenID Shared Signals and Events
              Profile of IETF Security Events 1.0", 2021,
              <http://openid.net/specs/openid-risc-profile-1_0.html>.

   [WebAuthn]
              Balfanz, D., "Web Authentication: An API for accessing
              Public Key Credentials Level 1", n.d.,
              <https://www.w3.org/TR/webauthn/>.








Cappalli & TulshibagwalExpires September 18, 2021              [Page 16]

Internet-Draft              CAEP-Event-Types                  March 2021


Authors' Addresses

   Tim Cappalli
   Microsoft

   Email: tim.cappalli@microsoft.com


   Atul Tulshibagwale
   Google

   Email: atultulshi@google.com







































Cappalli & TulshibagwalExpires September 18, 2021              [Page 17]
