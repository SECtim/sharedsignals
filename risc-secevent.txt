



                                                            M. Scurtescu
                                                                  Google
                                                              A. Backman
                                                                  Amazon
                                                                 P. Hunt
                                                                  Oracle
                                                              J. Bradley
                                                                  Yubico
                                                        January 26, 2018


                  RISC profile of IETF Security Events
                            risc-secevent-00

Abstract

   This is a RISC profile for several IETF Security Events drafts:

   o  Security Event Token (SET) [SET]

   o  SET Token Delivery Using HTTP [DELIVERY]

   o  Management API for SET Event Streams [API]

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Notational Conventions  . . . . . . . . . . . . . . . . .   2
   2.  Subject Identifiers . . . . . . . . . . . . . . . . . . . . .   2
     2.1.  Subject Identifier Types  . . . . . . . . . . . . . . . .   3
       2.1.1.  Email Subject Identifier Type . . . . . . . . . . . .   3
       2.1.2.  Phone Number Subject Identifier Type  . . . . . . . .   3
       2.1.3.  Issuer and Subject Subject Identifier Type  . . . . .   3
   3.  Profiles  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
     3.1.  Security Event Token Profle . . . . . . . . . . . . . . .   4
       3.1.1.  Signature Key Resolution  . . . . . . . . . . . . . .   4
       3.1.2.  RISC Event Subject  . . . . . . . . . . . . . . . . .   4
       3.1.3.  aud Claim . . . . . . . . . . . . . . . . . . . . . .   4
       3.1.4.  Security Considerations . . . . . . . . . . . . . . .   4
     3.2.  SET Token Delivery Using HTTP Profile . . . . . . . . . .   4
       3.2.1.  Authorization . . . . . . . . . . . . . . . . . . . .   4
     3.3.  Management API for SET Event Streams Profile  . . . . . .   5
       3.3.1.  Authorization . . . . . . . . . . . . . . . . . . . .   5
       3.3.2.  Subject Claims for Subject Add and Remove Operations    5
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
     4.1.  RISC Subject Identifier Types Registry  . . . . . . . . .   5
   5.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .   5
     5.1.  Subject Information Leakage . . . . . . . . . . . . . . .   5



Scurtescu, et al.         Expires July 30, 2018                 [Page 1]

                              risc-secevent                 January 2018


   6.  Normative References  . . . . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7

1.  Introduction

1.1.  Notational Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

2.  Subject Identifiers

   The RISC profile defines a structure called a Subject Identifier: a
   JSON object containing a set of claims that collectively uniquely
   identify a subject, according to a simple schema called a Subject
   Identifier Type.  Every Subject Identifier MUST contain a
   "subject_type" claim, whose value MUST be a name that uniquely
   identifies the Subject Identifier Type of the Subject Identifier.
   Any remaining claims within the Subject Identifier MUST be
   interpreted according to the definition of the Subject Identifier
   Type.  A Subject Identifier MUST conform to the Subject Identifier
   Type identified by its "subject_type" claim, and MUST NOT contain any
   claims not defined by its Subject Identifier Type.

   {
   "subject_type": "email",
   "email": "foo@example.com"
   }

   A Subject Identifier that identifies a subject by email address.

                Figure 1: Example: Email Subject Identifier

   {
   "subject_type": "iss-sub",
   "iss": "https://issuer.example.com/",
   "sub": "abc1234"
   }

   A Subject Identifier that identifies a subject by an identifier
   provided by an issuer.

         Figure 2: Example: Issuer and Subject Subject Identifier







Scurtescu, et al.         Expires July 30, 2018                 [Page 2]

                              risc-secevent                 January 2018


2.1.  Subject Identifier Types

   A Subject Identifier Type is a light-weight schema that describes a
   set of claims that uniquely identifies a subject.  Every Subject
   Identifier Type MUST have a unique name registered in the IANA "RISC
   Subject Identifier Types" registry established by Section 4.1.  A
   Subject Identifier Type MAY contain more claims than are strictly
   necessary to uniquely identify a subject, however a Subject
   Identifier MUST contain all of the claims required by its type (See
   Privacy Considerations).

   The following Subject Identifier Types are registered in the IANA
   "RISC Subject Identifier Types" registry established by Section 4.1.

2.1.1.  Email Subject Identifier Type

   The Email Subject Identifier Type describes a subject by email
   address.  Subject Identifiers of this type MUST contain an "email"
   claim whose value is a string containing the email address of the
   subject.  The "email" claim MUST NOT be null or empty.  The Email
   Subject Identifier Type is identified by the name "email".

2.1.2.  Phone Number Subject Identifier Type

   The Phone Number Subject Identifier Type describes a subject by
   telephone number.  Subject Identifiers of this type MUST contain a
   "phone" claim whose value is a string containing the full telephone
   number of the subject, including international dialing prefix,
   formatted according to E.164 [E164].  The "phone" claim MUST NOT be
   null or empty.  The Phone Number Subject Identifier Type is
   identified by the name "phone".

2.1.3.  Issuer and Subject Subject Identifier Type

   The Issuer and Subject Subject Identifier Type describes a subject by
   an issuer and a subject.  Subject Identifiers of this type MUST
   contain an "iss" claim whose value identifies the issuer, and a "sub"
   claim whose value identifies the subject with respect to the issuer.
   These claims MUST follow the formats of the "iss" claim and "sub"
   claim defined by [RFC7519], respectively.  Both the "iss" claim and
   the "sub" claim MUST NOT be null or empty.  The Issuer and Subject
   Subject Identifier Type is identified by the name "iss-sub".

3.  Profiles

   This section profiles several IETF secevent specifications.

   The RISC Profile makes several assumptions:



Scurtescu, et al.         Expires July 30, 2018                 [Page 3]

                              risc-secevent                 January 2018


   o  Transmitters are OpenID Connect Identity Providers

   o  Receivers are OpenID Connect Clients and as such have client ids
      issued by Transmitters

   o  In general the way subjects are identified is similar to OpenID
      Connect [OIDC] and Id Tokens [IDTOKEN] in particular.

   The RISC use cases that set the requirements are described in
   "Security Events RISC Use Cases" [USECASES].

3.1.  Security Event Token Profle

   This section provides RISC profiling specifications for the "Security
   Event Token (SET)" [SET] spec.

3.1.1.  Signature Key Resolution

   TODO: pointer to Management API section that describes discovery doc
   and the property that points to the key.

3.1.2.  RISC Event Subject

   The subject of a RISC event is identified by the "subject" claim
   within the event payload, whose value is a Subject Identifier.  The
   "subject" claim is REQUIRED for all RISC events.  The JWT "sub" claim
   MUST NOT be present in any SET containing a RISC event.

3.1.3.  aud Claim

   The 'aud' claim MUST be a single value which is the client id of the
   Receiver.

3.1.4.  Security Considerations

   TODO: Id Token and Access Token confusion

3.2.  SET Token Delivery Using HTTP Profile

   This section provides RISC profiling specifications for the "SET
   Token Delivery Using HTTP" [DELIVERY] spec.

3.2.1.  Authorization

   TODO






Scurtescu, et al.         Expires July 30, 2018                 [Page 4]

                              risc-secevent                 January 2018


3.3.  Management API for SET Event Streams Profile

   This section provides RISC profiling specifications for the
   "Management API for SET Event Streams" [API] spec.

3.3.1.  Authorization

   HTTP API calls from a receiver to a transmitter SHOULD be authorized
   using OAuth 2 Access Tokens.  The client id associated with the
   Access Token uniquely identifies the Receiver and the Stream.

   Receivers SHOULD use the Client Credential Grant [CLIENTCRED] to
   obtain access tokens on its own behalf.

3.3.2.  Subject Claims for Subject Add and Remove Operations

   TODO

4.  IANA Considerations

4.1.  RISC Subject Identifier Types Registry

   This section establishes the IANA "RISC Subject Identifier Types"
   registry for Subject Identifier Types.  The registry records the name
   of the Subject Identifier Type and a reference to the specification
   that defines it.  This section registers the Subject Identifier Types
   defined in Section 2.1.

   TODO: Finish registry definition

5.  Privacy Considerations

5.1.  Subject Information Leakage

   Event issuers and recipients SHOULD take precautions to ensure that
   they do not leak information about subjects via Subject Identifiers,
   and choose appropriate Subject Identifier Types accordingly.  Parties
   SHOULD NOT identify a subject using a given Subject Identifier Type
   if doing so will allow the recipient to correlate different claims
   about the subject that they are not known to already have knowledge
   of.  Issuers and recipients SHOULD always use the same Subject
   Identifier Type and the same claim values to identify a given subject
   when communicating with a given party in order to reduce the
   possibility of information leakage.







Scurtescu, et al.         Expires July 30, 2018                 [Page 5]

                              risc-secevent                 January 2018


6.  Normative References

   [API]      IETF, "Management API for SET Event Streams",
              <https://tools.ietf.org/html/draft-scurtescu-secevent-
              simple-control-plane>.

   [CLIENTCRED]
              Hardt, D., "The OAuth 2.0 Authorization Framework - Client
              Credentials Grant", RFC 6749,
              <https://tools.ietf.org/html/rfc6749#section-4.4>.

   [DELIVERY]
              IETF, "SET Token Delivery Using HTTP",
              <https://tools.ietf.org/html/draft-ietf-secevent-
              delivery>.

   [E164]     International Telecommunication Union, "The international
              public telecommunication numbering plan", 2010,
              <http://www.itu.int/rec/T-REC-E.164-201011-I/en>.

   [IDTOKEN]  OpenID Foundation, "OpenID Connect Core 1.0 - ID Token",
              <http://openid.net/specs/
              openid-connect-core-1_0.html#IDToken>.

   [JSON]     Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", RFC 7159, DOI 10.17487/RFC7159, March
              2014, <https://www.rfc-editor.org/info/rfc7159>.

   [OIDC]     OpenID Foundation, "OpenID Connect Core 1.0",
              <http://openid.net/specs/openid-connect-core-1_0.html>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997, <https://www.rfc-
              editor.org/info/rfc2119>.

   [RFC7519]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", RFC 7519, DOI 10.17487/RFC7519, May 2015,
              <https://www.rfc-editor.org/info/rfc7519>.

   [SET]      IETF, "Security Event Token (SET)",
              <https://tools.ietf.org/html/draft-ietf-secevent-token>.

   [USECASES]
              IETF, "Security Events RISC Use Cases",
              <https://tools.ietf.org/html/draft-scurtescu-secevent-
              risc-use-cases-00>.




Scurtescu, et al.         Expires July 30, 2018                 [Page 6]

                              risc-secevent                 January 2018


Authors' Addresses

   Marius Scurtescu
   Google

   Email: mscurtescu@google.com


   Annabelle Backman
   Amazon

   Email: richanna@amazon.com


   Phil Hunt
   Oracle Corporation

   Email: phil.hunt@yahoo.com


   John Bradley
   Yubico

   Email: secevemt@ve7jtb.com



























Scurtescu, et al.         Expires July 30, 2018                 [Page 7]
