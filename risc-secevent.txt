



                                                            M. Scurtescu
                                                                  Google
                                                              A. Backman
                                                                  Amazon
                                                                 P. Hunt
                                                                  Oracle
                                                              J. Bradley
                                                                  Yubico
                                                        October 01, 2017


                  RISC profile of IETF Security Events
                            risc-secevent-00

Abstract

   This is a RISC profile for several IETF Security Events drafts:

   o  Security Event Token (SET) [1]

   o  SET Token Delivery Using HTTP [2]

   o  Management API for SET Event Streams [3]

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Notational Conventions  . . . . . . . . . . . . . . . . .   2
   2.  Security Event Token Profle . . . . . . . . . . . . . . . . .   2
   3.  SET Token Delivery Using HTTP Profile . . . . . . . . . . . .   2
   4.  Management API for SET Event Streams Profile  . . . . . . . .   2
   5.  Event Types . . . . . . . . . . . . . . . . . . . . . . . . .   2
     5.1.  Account Credential Change Required  . . . . . . . . . . .   2
     5.2.  Account Deleted . . . . . . . . . . . . . . . . . . . . .   3
     5.3.  Account Disabled  . . . . . . . . . . . . . . . . . . . .   3
     5.4.  Account Enabled . . . . . . . . . . . . . . . . . . . . .   3
     5.5.  Identifier Changed  . . . . . . . . . . . . . . . . . . .   3
     5.6.  Identifier Recycled . . . . . . . . . . . . . . . . . . .   4
     5.7.  Opt Out . . . . . . . . . . . . . . . . . . . . . . . . .   4
       5.7.1.  Opt In  . . . . . . . . . . . . . . . . . . . . . . .   5
       5.7.2.  Opt Out Initiated . . . . . . . . . . . . . . . . . .   5
       5.7.3.  Opt Out Cancelled . . . . . . . . . . . . . . . . . .   6
       5.7.4.  Opt Out Effective . . . . . . . . . . . . . . . . . .   6
     5.8.  Recovery Activated  . . . . . . . . . . . . . . . . . . .   6
     5.9.  Recovery Information Changed  . . . . . . . . . . . . . .   6
     5.10. Sessions Revoked  . . . . . . . . . . . . . . . . . . . .   7
   6.  Normative References  . . . . . . . . . . . . . . . . . . . .   7
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7



Scurtescu, et al.         Expires April 4, 2018                 [Page 1]

                              risc-secevent                 October 2017


1.  Introduction

1.1.  Notational Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

2.  Security Event Token Profle

   TODO:

   o  signature key resolution

   o  subject composite claim

   o  security considerations for Id Token and Access Token confusion

3.  SET Token Delivery Using HTTP Profile

   TODO:

   o  authorization

4.  Management API for SET Event Streams Profile

   TODO:

   o  subject claims for add/remove operations

   o  authorization

5.  Event Types

5.1.  Account Credential Change Required

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/account-
   credential-change-required

   Account Credential Change Required signals that the account
   identified by the subject was required to change a credential.  For
   example the user was required to go through a password change.

   Attributes: none






Scurtescu, et al.         Expires April 4, 2018                 [Page 2]

                              risc-secevent                 October 2017


5.2.  Account Deleted

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/account-deleted

   Account Deleted signals that the account identified by the subject
   has been permanently deleted.

   Attributes: none

5.3.  Account Disabled

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/account-disabled

   Account Disabled signals that the account identified by the subject
   has been disabled.  The actual reason why the account was disabled
   might be specified with the nested 'reason' attribute described
   below.  The account may be enabled (Section 5.4) in the future.

   Attributes:

   o  reason - optional, describes why was the account disabled.
      Possible values:

      *  hijacking

      *  bulk-account

   o  cause-time - the initial cause that lead to the account to be
      disabled.  In most cases this is an estimated time.  For example,
      the actual hijacking time.  This is before the event time.

5.4.  Account Enabled

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/account-enabled

   Account Enabled signals that the account identified by the subject
   has been enabled.

   Attributes: none

5.5.  Identifier Changed

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/identifier-changed




Scurtescu, et al.         Expires April 4, 2018                 [Page 3]

                              risc-secevent                 October 2017


   Identifier Changed signals that the identifier specified in the
   subject has changed.  The subject MUST be either 'email' or 'phone-
   number' and it MUST specify the old value.

   Attributes:

   o  new-value - required, the new value of the identifier.

5.6.  Identifier Recycled

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/identifier-
   recycled

   Identifier Recycled signals that the identifier specified in the
   subject was recycled and now it belongs to a new user.  The subject
   MUST be either 'email' or 'phone-number'.

   Attributes: none

5.7.  Opt Out

   Users SHOULD be allowed to opt-in and out of RISC events being sent
   for their accounts.  With regards to opt-out an account can be in one
   of these three states:

   1.  opt-in - the account is participating in RISC event exchange.

   2.  opt-out-initiated - the user requested to be excluded from RISC
       event exchanges, but for practical security reasons for a period
       of time RISC events are still exchanged.  The main reason for
       this state is to prevent a hijacker from immediately opting out
       of RISC.

   3.  opt-out - the account is NOT participating in RISC event
       exchange.















Scurtescu, et al.         Expires April 4, 2018                 [Page 4]

                              risc-secevent                 October 2017


   State changes trigger Opt-Out Events as represented bellow:

           +--------+  opt-out-initiated  +-------------------+
           |        +--------------------->                   |
           | opt-in |                     | opt-out-initiated |
           |        |  pt-out-cancelled   |                   |
           |        <---------------------+                   |
           +---^----+                     +----------+--------+
               |                                     |
               | opt-in                              | opt-out-effective
               |                                     |
               |                          +----------V--------+
               |                          |                   |
               +--------------------------| opt-out           |
                                          |                   |
                                          +-------------------+

   Opt-Out States and Opt-Out Events

                                 Figure 1

   Both Transmitters and Receivers SHOULD manage Opt-Out state for
   users.  Transmitters should send the events defined in this section
   when the Opt-Out state changes.

5.7.1.  Opt In

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/opt-in

   Opt In signals that the account identified by the subject opted into
   RISC event exchanges.  The account is in the 'opt-in' state.

   Attributes: none

5.7.2.  Opt Out Initiated

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/opt-out-initiated

   Opt Out Initiated signals that the account identified by the subject
   initiated to opt out from RISC event exchanges.  The account is in
   the 'opt-out-initiated' state.

   Attributes: none






Scurtescu, et al.         Expires April 4, 2018                 [Page 5]

                              risc-secevent                 October 2017


5.7.3.  Opt Out Cancelled

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/opt-out-cancelled

   Opt Out Cancelled signals that the account identified by the subject
   cancelled the opt out from RISC event exchanges.  The account is in
   the 'opt-in' state.

   Attributes: none

5.7.4.  Opt Out Effective

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/opt-out-effective

   Opt Out Effective signals that the account identified by the subject
   was effectively opted out from RISC event exchanges.  The account is
   in the 'opt-out' state.

   Attributes: none

5.8.  Recovery Activated

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/recovery-activated

   Recovery Activated signals that the account identified by the subject
   activated a recovery flow.

   Attributes: none

5.9.  Recovery Information Changed

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/recovery-
   information-changed

   Recovery Information Changed signals that the account identified by
   the subject has changed some of its recovery information.  For
   example a recovery email address was added or removed.

   Attributes: none








Scurtescu, et al.         Expires April 4, 2018                 [Page 6]

                              risc-secevent                 October 2017


5.10.  Sessions Revoked

   Event Type URI:
   http://schemas.openid.net/secevent/risc/event-type/sessions-revoked

   Sessions Revoked signals that all the sessions for the account
   identified by the subject have been revoked.

   Attributes: none

6.  Normative References

   [API]      IETF, "Management API for SET Event Streams",
              <https://tools.ietf.org/html/draft-scurtescu-secevent-
              simple-control-plane-00>.

   [DELIVERY]
              IETF, "SET Token Delivery Using HTTP", <https://tools.ietf
              .org/html/draft-ietf-secevent-delivery-00>.

   [JSON]     Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", RFC 7159, DOI 10.17487/RFC7159, March
              2014, <https://www.rfc-editor.org/info/rfc7159>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/
              RFC2119, March 1997, <https://www.rfc-editor.org/info/
              rfc2119>.

   [RFC7519]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", RFC 7519, DOI 10.17487/RFC7519, May 2015,
              <https://www.rfc-editor.org/info/rfc7519>.

   [SET]      IETF, "Security Event Token (SET)", <https://tools.ietf
              .org/html/draft-ietf-secevent-token-02>.

   [USECASES]
              IETF, "Security Events RISC Use Cases",
              <https://tools.ietf.org/html/draft-scurtescu-secevent-
              risc-use-cases-00>.

Authors' Addresses

   Marius Scurtescu
   Google

   Email: mscurtescu@google.com




Scurtescu, et al.         Expires April 4, 2018                 [Page 7]

                              risc-secevent                 October 2017


   Annabelle Backman
   Amazon

   Email: richanna@amazon.com


   Phil Hunt
   Oracle Corporation

   Email: phil.hunt@yahoo.com


   John Bradley
   Yubico

   Email: secevemt@ve7jtb.com



































Scurtescu, et al.         Expires April 4, 2018                 [Page 8]
